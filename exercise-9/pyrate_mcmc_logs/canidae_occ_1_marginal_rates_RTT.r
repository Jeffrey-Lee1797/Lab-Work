# 1 files combined:
# 	/home/eeb177-student/Desktop/EEB-177/Lab-Work/exercise-9/pyrate_mcmc_logs/canidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/EEB-177/Lab-Work/exercise-9/pyrate_mcmc_logs/canidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.12271101609, 0.12271101609,0.12271101609,0.12271101609,0.0936942669295,0.0881659524347,0.0524902990721,0.0538752708019,0.0542870618608,0.0542870618608,0.0542870618608,0.0542870618608,0.0542870618608,0.0542870618608,0.0513193384871,0.0538752708019,0.0570140302421,0.0764248113353,0.0782626815426,0.0782626815426,0.0782626815426,0.0844749804951,0.0934535742662,0.0945000751921,0.0945000751921,0.0945000751921,0.0934535742662,0.0934535742662,0.0956575575983,0.0934535742662,0.0956575575983,0.134692442201,0.153194121209,0.153194121209,0.153194121209,0.153194121209,0.148780588168,0.148780588168,0.134692442201,0.134692442201,0.134692442201,0.0948589439849,0.148780588168,0.148780588168,0.148780588168,0.148780588168,0.148780588168,0.148780588168,0.148780588168,0.148780588168)
L_hpd_M95=c(0.343931650919, 0.343931650919,0.343931650919,0.343931650919,0.331669956922,0.327691260122,0.260022716117,0.156540546022,0.156540546022,0.156540546022,0.156540546022,0.156540546022,0.156540546022,0.156540546022,0.152276030086,0.156540546022,0.176684239291,0.19889992022,0.190952452356,0.190952452356,0.190952452356,0.20570026816,0.217723584012,0.217723584012,0.217723584012,0.217723584012,0.223120254899,0.234755821235,0.262898254219,0.339780040721,0.376608016955,0.416822777917,0.434607853122,0.434607853122,0.434607853122,0.434607853122,0.434607853122,0.434607853122,0.431570841483,0.431570841483,0.431570841483,0.395478595044,0.450903444787,0.445822296263,0.445822296263,0.445822296263,0.445822296263,0.445822296263,0.445822296263,0.445822296263)
M_hpd_m95=c(0.90780037165, 0.90780037165,0.0902037401718,0.0940310351553,0.0940310351553,0.0884160383172,0.0940310351553,0.0940310351553,0.0947188597937,0.0947188597937,0.0953258235109,0.0953258235109,0.0953258235109,0.0896470564237,0.0896470564237,0.0902037401718,0.0889492361533,0.086067449228,0.0832817477097,0.0832817477097,0.0832817477097,0.0827132396716,0.0800245462479,0.0771730981526,0.0719467838865,0.0704037941848,0.0704037941848,0.0704037941848,0.0704037941848,0.0704037941848,0.0582744988209,0.0582744988209,0.0582744988209,0.0582744988209,0.0392059722636,0.0272108215471,0.0274710272884,0.0272108215471,0.0212875696114,0.0212875696114,0.0212875696114,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036,0.0143177200036)
M_hpd_M95=c(1.55140100935, 1.55140100935,0.196137579819,0.196137579819,0.196137579819,0.191248221977,0.163431479774,0.161749367781,0.157962263726,0.157962263726,0.157962263726,0.157962263726,0.157962263726,0.150010828655,0.150010828655,0.150010828655,0.141909287918,0.138485751775,0.134231131776,0.133276786597,0.133276786597,0.136059790935,0.136059790935,0.136059790935,0.131250425073,0.131250425073,0.134231131776,0.134231131776,0.134745594562,0.138067766786,0.132606187829,0.132606187829,0.134745594562,0.134745594562,0.132734553735,0.126425777586,0.131495698432,0.135823047038,0.137500876597,0.154896175333,0.157472112388,0.200758045456,0.200758045456,0.200758045456,0.200758045456,0.200758045456,0.200758045456,0.200758045456,0.200758045456,0.200758045456)
R_hpd_m95=c(-1.24596397737, -1.24596397737,-0.00110389541269,-0.00461530144179,-0.0398424472817,-0.0519236781492,-0.0947592106039,-0.08388350583,-0.0719378307875,-0.0719378307875,-0.0719378307875,-0.0719378307875,-0.0719378307875,-0.0719378307875,-0.0719378307875,-0.0644896048029,-0.062976510253,-0.0519644603524,-0.048543877341,-0.039785723654,-0.039785723654,-0.039785723654,-0.0362810841696,-0.0364729016703,-0.0364729016703,-0.0364729016703,-0.0364729016703,-0.0364729016703,-0.0362810841696,-0.0340235316305,0.00716740323422,0.0230872003234,0.0230872003234,0.0230872003234,0.0611541480091,0.0623830785563,0.0605318764222,0.0605318764222,0.0111463828161,0.0111463828161,0.00710396633222,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394,-0.0307019120394)
R_hpd_M95=c(-0.581876271173, -0.581876271173,0.23597614948,0.229192205444,0.206740717577,0.206740717577,0.148865025337,0.0407436415736,0.0426953001639,0.0426953001639,0.0426953001639,0.0426953001639,0.0425421518166,0.0411215369034,0.0369130983556,0.0460757103878,0.0691915027947,0.0779642725054,0.0779642725054,0.0881796105119,0.0881796105119,0.0977732662937,0.11087837476,0.11087837476,0.115536162117,0.115536162117,0.118193002655,0.118808259372,0.144871457741,0.233854670313,0.309357661056,0.319396518677,0.319396518677,0.319396518677,0.36053192948,0.36053192948,0.36053192948,0.366458426829,0.34560372801,0.34560372801,0.34560372801,0.355610751368,0.355610751368,0.355610751368,0.355610751368,0.355610751368,0.355610751368,0.355610751368,0.355610751368,0.355610751368)
L_mean=c(0.256908428956, 0.256908428956,0.256928293443,0.256980925726,0.230931333673,0.200302637378,0.123430940083,0.10336898099,0.102610715045,0.102610715045,0.102494043228,0.102494043228,0.102494043228,0.10281549127,0.102649879436,0.105463067738,0.117952834144,0.123514256257,0.127429969563,0.129347421561,0.130786227532,0.13787406969,0.146138341744,0.148553755041,0.148627926185,0.148442313031,0.147550682096,0.146989112755,0.151409578192,0.179068896878,0.249922041796,0.275705055415,0.278947451241,0.279590595097,0.279590595097,0.279590595097,0.279388621467,0.279770510246,0.275425261694,0.274198359314,0.27330275474,0.273434645676,0.274140654712,0.274335498702,0.273635368687,0.273217397023,0.272796403107,0.272796403107,0.272796403107,0.271599385458)
M_mean=c(1.15745360207, 1.15745360207,0.133447757231,0.131606170829,0.131606170829,0.131043073582,0.125311577885,0.123452647824,0.121351148233,0.121161344601,0.12090460693,0.120160996131,0.119651233053,0.118958317972,0.117089683741,0.115823066122,0.112460419506,0.110700499677,0.110035176196,0.109906480537,0.109827717688,0.108887473995,0.106964744631,0.106092704001,0.105134331073,0.104305434401,0.10255753002,0.101971768184,0.101342381348,0.10041945197,0.0982809023575,0.0978817820397,0.0973911801968,0.0967064826479,0.0924762322382,0.0838061267103,0.0810012907308,0.0800571209563,0.0810984423618,0.0822106473174,0.0830757484551,0.0898384651814,0.0903852847596,0.0903852847596,0.0903852847596,0.0903852847596,0.0903852847596,0.0903852847596,0.0903852847596,0.0903852847596)
R_mean=c(-0.90054517311, -0.90054517311,0.123480536211,0.125374754897,0.0993251628441,0.0692595637964,-0.00188063780228,-0.020083666834,-0.0187404331889,-0.0185506295567,-0.0184105637016,-0.0176669529025,-0.0171571898252,-0.0161428267013,-0.0144398043048,-0.0103599983847,0.00549241463876,0.0128137565805,0.017394793367,0.0194409410231,0.0209585098444,0.0289865956944,0.0391735971131,0.0424610510397,0.043493595112,0.0441368786308,0.0449931520757,0.0450173445704,0.0500671968443,0.0786494449079,0.151641139439,0.177823273375,0.181556271044,0.182884112449,0.187114362859,0.195784468387,0.198387330737,0.19971338929,0.194326819333,0.191987711997,0.190227006285,0.183596180495,0.183755369952,0.183950213942,0.183250083927,0.182832112263,0.182411118348,0.182411118348,0.182411118348,0.181214100699)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.495993789265), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.70654111029), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.37056037511, 0.403104269512), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()